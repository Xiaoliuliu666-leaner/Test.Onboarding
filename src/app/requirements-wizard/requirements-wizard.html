<a routerLink="/" class="back-home-link">‚Üê Back to Home</a>

<div class="wizard-layout">
  <!-- Left Side Navigation -->
  <aside class="wizard-sidebar">
  <ul>
    <!-- Step 1: Tenant -->
    <li [class.active]="stepIndex === 1">Step 1: Tenant</li>
    <ng-container *ngIf="formData.tenant">
    <li class="step-summary-item">
      {{
        formData.tenant === '__new__'
          ? formData.newTenantName
          : formData.tenant
      }}
    </li>
    <li class="step-summary-item" *ngIf="formData.contactEmail">{{ formData.contactEmail }}</li>
    <li class="step-summary-item" *ngIf="formData.contactPhone">{{ formData.contactPhone }}</li>
  </ng-container>

    <!-- Step 2: Modules -->
    <li [class.active]="stepIndex === 2">Step 2: Modules</li>
    <ng-container *ngIf="formData.modules && formData.modules.length">
      <li class="step-summary-item" *ngFor="let module of formData.modules">{{ module }}</li>
    </ng-container>


    <!-- Step 3: Notes -->
    <li [class.active]="stepIndex === 3">Step 3: Notes</li>
    <ng-container *ngIf="formData.configNotes">
      <li class="step-summary-item">{{ formData.configNotes | slice: 0:30 }}...</li>
    </ng-container>
  </ul>
</aside>


  <!-- Main Content Area -->
  <div class="wizard-container">
    <div class="step-indicator">Step {{ stepIndex }} of 3</div>
    <h2>Step {{ stepIndex }}</h2>

  <!-- Step 1 -->
  <div *ngIf="stepIndex === 1">
    <label for="tenant">Select Tenant:</label>
    <select [(ngModel)]="formData.tenant" (change)="checkNewTenant()" id="tenant">
      <option value="" disabled selected>Select...</option>
      <option *ngFor="let t of tenants" [value]="t">{{ t }}</option>
      <option value="__new__">+ New Tenant</option>
    </select>

  <div *ngIf="isCreatingNewTenant">
    <label>Enter New Tenant Name:</label>
    <input type="text" [(ngModel)]="formData.newTenantName" placeholder="Enter new tenant name..." />

    <label>Contact Name:</label>
    <input type="text" [(ngModel)]="formData.contactName" placeholder="Enter contact name..." />

    <label>Contact Email:</label>
    <input type="email" [(ngModel)]="formData.contactEmail" placeholder="Enter contact email..." />

    <label>Contact Phone:</label>
    <input type="tel" [(ngModel)]="formData.contactPhone" placeholder="Enter contact phone..." />

    <label>Your Name (Created By):</label>
    <input type="text" [(ngModel)]="formData.createdBy" placeholder="Enter your name..." />

    </div>
  </div>

  <!-- Step 2 -->
  <div *ngIf="stepIndex === 2">
    <div class="module-grid">
      <div
        *ngFor="let module of availableModules"
        class="module-item"
        [class.selected]="formData.modules.includes(module.name)"
      >
        <label class="module-row">
          <input
            type="checkbox"
            [value]="module.name"
            (change)="onModuleChange($event)"
            [checked]="formData.modules.includes(module.name)"
          />
          <div class="module-title">{{ module.name }}</div>
          <div class="module-description">{{ module.description }}</div>
        </label>
      </div>
    </div>

            <!-- Selected module preview panel -->
            <!-- <div *ngIf="formData.modules.length" class="selected-module-panel">
              <strong>Selected Modules:</strong>
              <ul>
                <li *ngFor="let m of formData.modules">{{ m }}</li>
              </ul>
            </div> -->
    </div>

    <!-- Step 3 -->
    <div *ngIf="stepIndex === 3">
      <label>Configuration Notes:</label>
      <textarea [(ngModel)]="formData.configNotes" rows="5"></textarea>

      <p *ngIf="formData.configNotes.trim().length < 10" style="color: red; font-size: 13px; margin-top: 4px;">
        Please enter at least 10 characters.
      </p>
    </div>

    <!-- Buttons -->
    <div class="wizard-nav">
      <button (click)="previousStep()" [disabled]="stepIndex === 1">Previous</button>
      <button *ngIf="stepIndex < 3" (click)="nextStep()" [disabled]="!isStepValid()">Next</button>
      <button *ngIf="stepIndex === 3" (click)="submitWizard()" [disabled]="!isStepValid()">Submit</button>
    </div>
  </div>
